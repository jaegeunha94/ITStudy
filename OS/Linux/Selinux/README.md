# SELinuxë€?
SELinux(Security-Enhanced Linux)ëŠ” ê´€ë¦¬ìê°€ ì‹œìŠ¤í…œ ì•¡ì„¸ìŠ¤ ê¶Œí•œì„  
íš¨ê³¼ì ìœ¼ë¡œ ì œì–´í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” LinuxÂ® ì‹œìŠ¤í…œìš© ë³´ì•ˆ ì•„í‚¤í…ì²˜ë‹¤.  
ì´ëŠ” ì›ë˜ ë¯¸êµ­ êµ­ê°€ì•ˆë³´êµ­(NSA)ì´ LSM(Linux Security Module)ì„ ì‚¬ìš©í•˜ëŠ” 
Linux ì»¤ë„ì— ëŒ€í•œ ì¼ë ¨ì˜ íŒ¨ì¹˜ë¡œ ê°œë°œí•œ ê²ƒì…ë‹ˆë‹¤.  

SELinuxëŠ” 2000ë…„ì— ì˜¤í”ˆì†ŒìŠ¤ ì»¤ë®¤ë‹ˆí‹°ì— ë¦´ë¦¬ìŠ¤ë˜ì–´  
2003ë…„ì— ì—…ìŠ¤íŠ¸ë¦¼ Linux ì»¤ë„ë¡œ í†µí•©ë˜ì—ˆë‹¤.

ì¦‰, SELinux ëŠ” Linuxì˜ ë³´ì•ˆì„ ê°•í™”í•´ ì£¼ëŠ” ë³´ì•ˆ ê°•í™” ì»¤ë„ì´ê³   
zero-day ê³µê²© ë° buffer overflow ë“±  
ì–´í”Œë¦¬ì¼€ì´ì…˜ ì·¨ì•½ì ìœ¼ë¡œ ì¸í•œ í•´í‚¹ì„ ë°©ì§€í•´ ì£¼ëŠ” í•µì‹¬ êµ¬ì„±ìš”ì†Œì´ë‹¤.

íŠ¹ì • ì„œë¹„ìŠ¤ê°€ SELinux ë•Œë¬¸ì— ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ SELinux ë¥¼ ë„ê¸° ë³´ë‹¤ëŠ”  
í•´ë‹¹ ì„œë¹„ìŠ¤ê°€ SELinux í•˜ì—ì„œ ì˜ ë™ì‘í•˜ë„ë¡ ì„¤ì •ì„ ìˆ˜ì •í•˜ëŠ”ê±¸ ê¶Œì¥í•œë‹¤.

# ğŸ“‘SELinuxëŠ” ì–´ë–»ê²Œ ì‘ë™í•˜ë‚˜ìš”?
SELinuxëŠ” ì‹œìŠ¤í…œì˜ ì• í”Œë¦¬ì¼€ì´ì…˜, í”„ë¡œì„¸ìŠ¤,  
íŒŒì¼ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ ì œì–´ë¥¼ ì •ì˜í•œë‹¤.  

ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” í•­ëª©ê³¼ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ì—†ëŠ” í•­ëª©ì„ SELinuxì— ì§€ì •í•˜ëŠ”  
ë£° ì„¸íŠ¸ì¸ ë³´ì•ˆ ì •ì±…ì„ ì‚¬ìš©í•˜ì—¬ ì •ì±…ì—ì„œ í—ˆìš©ë˜ëŠ” ì•¡ì„¸ìŠ¤ë¥¼ ì ìš©í•œë‹¤. 

ì£¼ì²´ë¡œ ì•Œë ¤ì§„ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ í”„ë¡œì„¸ìŠ¤ê°€ íŒŒì¼ê³¼ ê°™ì€ ê°ì²´ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ìš”ì²­í•˜ëŠ” ê²½ìš°,    
SELinuxëŠ” ì£¼ì²´ì™€ ê°ì²´ì— ëŒ€í•´ ê¶Œí•œì´ ìºì‹œë˜ëŠ” AVC(Access Vector Cashe)ë¥¼ í™•ì¸í•œë‹¤.

SELinuxê°€ ìºì‹œëœ ê¶Œí•œì— ê¸°ë°˜í•œ ì•¡ì„¸ìŠ¤ì— ëŒ€í•œ ê²°ì •ì„ ë‚´ë¦´ ìˆ˜ ì—†ëŠ” ê²½ìš°  
ë³´ì•ˆ ì„œë²„ì— ìš”ì²­ì„ ì „ì†¡í•œë‹¤.  

ë³´ì•ˆ ì„œë²„ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ í”„ë¡œì„¸ìŠ¤ì˜ ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ì™€ íŒŒì¼ì„ í™•ì¸í•œë‹¤.  
ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ëŠ” SELinux ë³´ì•ˆ ì •ì±… ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì ìš©ëœë‹¤.  
ê·¸ëŸ¬ë©´ ê¶Œí•œì´ í—ˆìš©ë˜ê±°ë‚˜ ê±°ë¶€ëœë‹¤. 

ê¶Œí•œì´ ê±°ë¶€ë˜ë©´ "avc: denied"ë¼ëŠ” ë©”ì‹œì§€ê°€ 

`/var/log.messages`ì— ë‚˜íƒ€ë‚œë‹¤.

# ğŸ“‘SELinux êµ¬ì„± ë°©ë²• 
SELinuxë¥¼ ì„¤ì •í•˜ì—¬ ì‹œìŠ¤í…œì„ ë³´í˜¸í•  ìˆ˜ ìˆëŠ” ëª‡ ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.  
ê°€ì¥ ì¼ë°˜ì ì¸ ë°©ë²•ì€ íƒ€ê²Ÿ ì •ì±… ë˜ëŠ” ë‹¤ë‹¨ê³„ ë³´ì•ˆ(Multi-Level Security, MLS)ì´ë‹¤.

íƒ€ê²Ÿ ì •ì±…ì€ ê¸°ë³¸ ì˜µì…˜ìœ¼ë¡œì„œ ë‹¤ì–‘í•œ í”„ë¡œì„¸ìŠ¤ì™€ íƒœìŠ¤í¬ ë° ì„œë¹„ìŠ¤ë¥¼ ì²˜ë¦¬í•œë‹¤.  
MLSëŠ” ë§¤ìš° ë³µì¡í•  ìˆ˜ ìˆìœ¼ë©°, ì¼ë°˜ì ìœ¼ë¡œ ì •ë¶€ ê¸°ê´€ì—ì„œë§Œ ì‚¬ìš©í•œë‹¤. 

/etc/sysconfig/selinux íŒŒì¼ì„ ë³´ë©´ ì‹œìŠ¤í…œì´  
ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.  

íŒŒì¼ì—ëŠ” SELinuxê°€ í—ˆìš© ëª¨ë“œì¸ì§€ ì‹¤í–‰ ëª¨ë“œì¸ì§€ ì•„ë‹ˆë©´  
ë¹„í™œì„±í™” ëª¨ë“œì¸ì§€ì™€ ì–´ë–¤ ì •ì±…ì„ ë¡œë“œí•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ì„¹ì…˜ì´ ìˆë‹¤.



# ğŸ“‘SELinux ì˜¤ë¥˜ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•
SELinuxì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²½ìš° í•´ê²°í•´ì•¼ í•˜ëŠ” ì‚¬í•­ì´ ìˆë‹¤.  
ë‹¤ìŒì˜ 4ê°€ì§€ ì¼ë°˜ì ì¸ ë¬¸ì œ ì¤‘ í•˜ë‚˜ì¼ ìˆ˜ ìˆë‹¤.

1. ë ˆì´ë¸”ì´ ì˜ëª»ëœ ê²½ìš°: ë ˆì´ë¸”ì´ ì˜¬ë°”ë¥´ì§€ ì•Šì€ ê²½ìš° íˆ´ì„ ì‚¬ìš©í•˜ì—¬ ë ˆì´ë¸”ì„ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.
2. ì •ì±… ìˆ˜ì •ì´ í•„ìš”í•œ ê²½ìš°: ë³€ê²½ ì‚¬í•­ì— ëŒ€í•´ SELinuxì— ì•Œë ¤ì•¼ í•˜ê±°ë‚˜ ì •ì±…ì„ ì¡°ì •í•´ì•¼ í•  ìˆ˜ë„ ìˆë‹¤.  
  * ë¶€ìš¸ ë˜ëŠ” ì •ì±… ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
3. ì •ì±…ì— ë²„ê·¸ê°€ ìˆëŠ” ê²½ìš°: ì •ì±…ì— í•´ê²°í•´ì•¼ í•˜ëŠ” ë²„ê·¸ê°€ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤.
4. ì‹œìŠ¤í…œì´ ì¹¨ì…ì„ ë‹¹í•œ ê²½ìš°: ëŒ€ë¶€ë¶„ì˜ ê²½ìš° SELinuxê°€ ì‹œìŠ¤í…œì„ ë³´í˜¸í•  ìˆ˜ëŠ” ìˆìœ¼ë‚˜ ì‹œìŠ¤í…œ ì†ìƒì´ ì¼ì–´ë‚  ê°€ëŠ¥ì„±ì€ ì—¬ì „íˆ ì¡´ì¬í•œë‹¤.  
  * ì´ëŸ° ìƒí™©ì´ ì˜ì‹¬ë˜ëŠ” ê²½ìš° ì¦‰ì‹œ ì¡°ì¹˜ë¥¼ ì·¨í•´ì•¼ í•œë‹¤.


> ë¶€ìš¸ì´ë€?  
> ë¶€ìš¸(boolean)ì´ë€ SELinuxì˜ ê¸°ëŠ¥ì— ëŒ€í•œ í™œì„±í™”/ë¹„í™œì„±í™” ì„¤ì •ì´ë‹¤.  
> SELinux ê¸°ëŠ¥ì„ ì¼œê±°ë‚˜ ëŒ ìˆ˜ ìˆëŠ” ìˆ˜ë°± ê°€ì§€ ì„¤ì •ì´ ìˆìœ¼ë©°   
> ì´ ì¤‘ ë‹¤ìˆ˜ëŠ” ì´ë¯¸ ì‚¬ì „ ì •ì˜ë˜ì–´ ìˆë‹¤.  
> getsebool -aë¥¼ ì‹¤í–‰í•˜ì—¬ ì‹œìŠ¤í…œì— ì´ë¯¸ ì„¤ì •ëœ ë¶€ìš¸ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.
> 

# SELinux ë™ì‘ ëª¨ë“œ
enforce, permissive, disable ì„¸ ê°€ì§€ ëª¨ë“œê°€ ìˆìœ¼ë©° RHEL/CentOS ë¥¼ ì„¤ì¹˜í•˜ë©´  
default ë¡œ enforce mode ë¡œ ë™ì‘í•˜ë©° SELinux ì˜ rule ì— ì–´ê¸‹ë‚˜ëŠ” operation ì€ ê±°ë¶€ëœë‹¤.

í˜„ì¬ SELinux ì˜ ë™ì‘ ëª¨ë“œëŠ” sestatus ëª…ë ¹ì–´ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

# SELinux ëª¨ë“œ í™•ì¸

`$ sestatus`

```
SELinux status: enabled
SELinuxfs mount: /selinux
Current mode: enforcing
Mode from config file: enforcing
Policy version: 24
Policy from config file: targeted
Plain text
```

Permissive mode ëŠ” rule ì— ì–´ê¸‹ë‚˜ëŠ” ë™ì‘ì´ ìˆì„ ê²½ìš° audit log ë¥¼ ë‚¨ê¸°ê³  í•´ë‹¹ operation ì€ í—ˆìš©ëœë‹¤.

ê°œë°œ ì„œë²„ì¼ ê²½ìš° íŠ¹ì • daemon ì´ë‚˜ ì„œë¹„ìŠ¤ì— ë¬¸ì œê°€ ìˆì„ ê²½ìš° setenforce 0 ìœ¼ë¡œ  
Permissive mode ë¡œ ì „í™˜í•˜ì—¬ ë¬¸ì œ í•´ê²°í›„ enforce mode ë¡œ ì „í™˜í•˜ëŠ”ê±¸ ì¶”ì²œí•œë‹¤.

```
$ setenforce 0
$ sestatus 

SELinux status: enabled
SELinuxfs mount: /selinux
Current mode: permissive
Mode from config file: enforcing
Policy version: 24
Policy from config file: targeted
```


# SELinux í•´ì œ

ì¸í„°ë„·ì— ì—°ê²°ëœ ë¦¬ëˆ…ìŠ¤ ì„œë²„ë¼ë©´ SELinux í•´ì œëŠ” ê²°ì½” ì¶”ì²œí•˜ì§€ ì•ŠëŠ”ë‹¤.  
í•´ì œí•  ê²½ìš° ë‹¤ì‹œ í™œì„±í™” ì‹œí‚¤ë ¤ë©´ ì¬ë¶€íŒ…ì´ í•„ìš”í•˜ë©° ì¬ë¶€íŒ…ì‹œ ëª¨ë“  ìì›ì— ëŒ€í•´  
ë³´ì•ˆ ë ˆì´ë¸”ì„ ì„¤ì •í•´ì•¼ í•˜ë¯€ë¡œ ë¶€íŒ… ì‹œê°„ì´ ë§¤ìš° ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆë‹¤.  

## 1. SELinux ì„¤ì • íŒŒì¼ì„ í¸ì§‘ê¸°ë¡œ ì—°ë‹¤.
```
RHEL/CentOS 8

vi /etc/selinux/config
```
```
RHEL/CentOS 7 ì´ì „

vi /etc/sysconfig/selinux
```

## 2. SELINUX=enforcing ì„ SELINUX=disabled ë¡œ ë³€ê²½í›„ ì €ì¥í•œë‹¤.
```
SELINUX=disabled
```

## 3. reboot

SELinux ë¥¼ í•´ì œí›„ ë‹¤ì‹œ ì¼¤ ê²½ìš° relabel ì´ í•„ìš”í•˜ë©° ì´ë•Œ ì˜ëª»ëœ ì„¤ì •ì´ ìˆì„ ê²½ìš° ë¶€íŒ…ì´ ì•ˆ ë˜ê±°ë‚˜  
ssh ë¡œ ì›ê²© ì ‘ì†ì´ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ enforcing ëª¨ë“œê°€ ì•„ë‹Œ permissive ë¡œ ì„¤ì •í›„ ì¬ë¶€íŒ…í•˜ëŠ” ê²ƒì„ ê¶Œì¥



# SELinux ì‚¬ìš©ì‹œ port ê´€ë¦¬ ë°©ë²•
## ì˜¤í”ˆëœ http port í™•ì¸ë°©ë²•
`# semanage port -l | grep http_port_t`

## http port ì˜¤í”ˆí•˜ê¸° ìœ„í•´ ì¶”ê°€í•´ì£¼ëŠ” ë°©ë²•
`# semanage port -a -t http_port_t -p tcp 33081`



# ì°¸ì¡°
[redhat](https://www.redhat.com/ko/topics/linux/what-is-selinux)

[lesstif](https://www.lesstif.com/system-admin/centos-selinux-6979732.html)
